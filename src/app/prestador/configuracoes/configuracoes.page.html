<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Configurações</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  @if (isLoading) {
    <div class="loading-container">
      <ion-spinner></ion-spinner>
      <p>Carregando configurações...</p>
    </div>
  } @else if (hasStore && store) {
    <div class="store-container">
      <div class="store-header">
        <ion-avatar class="store-avatar">
          @if (store.imageUrl) {
            <img [src]="store.imageUrl" [alt]="store.name" />
          } @else {
            <div class="avatar-placeholder">
              <ion-icon name="storefront-outline"></ion-icon>
            </div>
          }
        </ion-avatar>
        <h2 class="store-name">{{ store.name }}</h2>
        <ion-button fill="outline" (click)="openEditModal()" class="edit-button">
          <ion-icon name="create-outline" slot="start"></ion-icon>
          Editar Loja
        </ion-button>
      </div>

      <ion-card class="info-card">
        <ion-card-header>
          <ion-card-title>Informações da Loja</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <ion-list>
            <ion-item lines="none" class="info-item">
              <ion-icon name="storefront-outline" slot="start" class="info-icon"></ion-icon>
              <ion-label>
                <h3>Nome</h3>
                <p>{{ store.name }}</p>
              </ion-label>
            </ion-item>

            <ion-item lines="none" class="info-item">
              <ion-icon name="time-outline" slot="start" class="info-icon"></ion-icon>
              <ion-label>
                <h3>Intervalo entre Agendamentos</h3>
                <p>{{ getAppointmentIntervalLabel(store.appointmentInterval) }}</p>
              </ion-label>
            </ion-item>
          </ion-list>
        </ion-card-content>
      </ion-card>

      <ion-card class="info-card">
        <ion-card-header>
          <ion-card-title>Localização</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <ion-list>
            <ion-item lines="none" class="info-item">
              <ion-icon name="location-outline" slot="start" class="info-icon"></ion-icon>
              <ion-label>
                <h3>Endereço</h3>
                <p>{{ formatAddress(store.location) }}</p>
              </ion-label>
            </ion-item>
          </ion-list>
        </ion-card-content>
      </ion-card>

      <ion-card class="info-card">
        <ion-card-header>
          <ion-card-title>Horários de Funcionamento</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <ion-list>
            @for (wh of store.workingHours; track wh.dayOfWeek) {
              <ion-item lines="none" class="info-item">
                <ion-icon name="calendar-outline" slot="start" class="info-icon"></ion-icon>
                <ion-label>
                  <h3>{{ getDayName(wh.dayOfWeek) }}</h3>
                  <p>
                    @if (wh.isOpen && wh.openTime && wh.closeTime) {
                      {{ formatTime(wh.openTime) }} - {{ formatTime(wh.closeTime) }}
                    } @else {
                      Fechado
                    }
                  </p>
                </ion-label>
              </ion-item>
            }
          </ion-list>
        </ion-card-content>
      </ion-card>

      <ion-card class="info-card">
        <ion-card-header>
          <ion-card-title>Informações da Conta</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <ion-list>
            <ion-item lines="none" class="info-item">
              <ion-icon name="calendar-outline" slot="start" class="info-icon"></ion-icon>
              <ion-label>
                <h3>Loja criada em</h3>
                <p>{{ formatDate(store.createdAt) }}</p>
              </ion-label>
            </ion-item>

            <ion-item lines="none" class="info-item">
              <ion-icon name="time-outline" slot="start" class="info-icon"></ion-icon>
              <ion-label>
                <h3>Última atualização</h3>
                <p>{{ formatDate(store.updatedAt) }}</p>
              </ion-label>
            </ion-item>
          </ion-list>
        </ion-card-content>
      </ion-card>
    </div>
  } @else {
    <div class="no-store-container">
      <ion-card class="empty-card">
        <ion-card-header>
          <ion-card-title>Nenhuma Loja Cadastrada</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <div class="empty-content">
            <ion-icon name="storefront-outline" class="empty-icon"></ion-icon>
            <p>Você ainda não possui uma loja cadastrada.</p>
            <p class="empty-description">Crie sua loja para começar a receber agendamentos.</p>
            <ion-button expand="block" (click)="openCreateModal()" class="create-button">
              <ion-icon name="add-outline" slot="start"></ion-icon>
              Criar Loja
            </ion-button>
          </div>
        </ion-card-content>
      </ion-card>
    </div>
  }
</ion-content>
